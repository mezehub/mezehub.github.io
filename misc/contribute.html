<!DOCTYPE html>
<html lang="en">
<head>
    <title>Contribute</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=0.25">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <link rel="icon" href="mezehub.png" type="image/gif">
     <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <style>     
        .role-crown { color: #98FB98; }
        .role-master999 { color: #f1c40f; }
        .role-prayergod { color: #0051ff; }
        .role-monstiecollector { color: #d05380; }
        .role-roadmaster { color: #000094; }
        .role-z4roadmaster { color: #11ec11; }
        .role-z4easy { color: #00feff; }
        .role-lonewolf { color: #ff8b60; }
        .role-masterofallweapons { color: #e91e63; }
        .role-sns { color: #9b59b6; }
        .role-ds { color: #9b59b6; }
        .role-gs { color: #9b59b6; }
        .role-ls { color: #9b59b6; }
        .role-hammer { color: #9b59b6; }
        .role-hh { color: #9b59b6; }
        .role-lance { color: #9b59b6; }
        .role-gl { color: #9b59b6; }
        .role-swaxe { color: #9b59b6; }
        .role-tonfa { color: #9b59b6; }
        .role-lbg { color: #9b59b6; }
        .role-hbg { color: #9b59b6; }
        .role-bow { color: #9b59b6; }</style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
            <a class="navbar-brand" href="index.html">
                <img src="mezehub.png" alt="Logo" width="150px" height="auto" style="padding-left: 10%;">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <!-- Include your existing navbar content here -->
                <div class="container-fluid">
                    <div class="row">
                        <div class="col">
                            <ul class="navbar-nav justify-content-center text-center">
                                <li class="nav-item">
                                    <a class="nav-link" href="index.html">Introduction</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="crown-hunter.html">🏆Crown Hunter🏆</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="lone-wolf.html">✹Lone Wolf✹</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="road-master.html">💀Road Master💀</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="z4-road-master.html">💀Z4 Road Master💀</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="z4-easy.html">♘Z4 Easy♘</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="monstie-collector.html">Wallpaper Enthusiast</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <ul class="navbar-nav justify-content-center text-center">
                                <li class="nav-item">
                                    <a class="nav-link" href="master-of-999.html">⭐Master of 999⭐</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="master-of-all-weapons.html">🏅Master of All Weapons🏅</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="sns-master.html">🏅SNS Master🏅</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="ds-master.html">🏅DS Master🏅</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="gs-master.html">🏅GS Master🏅</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="ls-master.html">🏅LS Master🏅</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <ul class="navbar-nav justify-content-center text-center">
                                <li class="nav-item">
                                    <a class="nav-link" href="hammer-master.html">🏅Hammer Master🏅</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="hh-master.html">🏅HH Master🏅</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="lance-master.html">🏅Lance Master🏅</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="gl-master.html">🏅GL Master🏅</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="swaxe-master.html">🏅Swaxe Master🏅</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="tonfa-master.html">🏅Tonfa Master🏅</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <ul class="navbar-nav justify-content-center text-center">
                                <li class="nav-item">
                                    <a class="nav-link" href="lbg-master.html">🏅LBG Master🏅</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="hbg-master.html">🏅HBG Master🏅</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="bow-master.html">🏅Bow Master🏅</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <ul class="navbar-nav justify-content-center text-center">
                                <li class="nav-item">
                                    <a class="nav-link" href="prayer-god.html">⭐Prayer God⭐</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <ul class="navbar-nav justify-content-center text-center">
                                <li class="nav-item">
                                    <a href="guide.html"><button type="button" class="btn btn-dark">Guides</button></a>
                                </li>
                                <li class="nav-item">
                                    <a href="extras.html"><button type="button" class="btn btn-success">Extras</button></a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            </div>
    </nav>
    <h1 style="text-align: center;font-size: 35px;padding-top: 50px;color: #ffffff;">What would you like to upload?</h1>
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 0;
            background-image: url('images/10.jpg') !important;
            background-size: cover;
        }
    </style>

    <div class="container">
        <p class="text-center text-white">Only users that are logged in may upload armor sets/notes.</p>
        <div class="text-center">
            <a href="login.html" class="btn btn-primary mb-3" id="loginButton">Login</a>
        </div>
        <form id="choiceForm" class="text-center mb-5" style="display:none;">
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="contributionChoice" id="armorSetChoice" value="armorSet" required>
                <label class="form-check-label" for="armorSetChoice">Armor Set</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="contributionChoice" id="achievementNotesChoice" value="achievementNotes" required>
                <label class="form-check-label" for="achievementNotesChoice">Notes on the Achievement Run</label>
            </div>
        </form>

        <form id="uploadForm" class="text-center" style="display:none;">
            <div class="mb-3">
                <label for="guideSelect" class="form-label">Select Guide</label>
                <select class="form-select" id="guideSelect" required>
                    <option value="sns-guide">🏅SNS Master🏅</option>
                    <option value="ds-guide">🏅DS Master🏅</option>
                    <option value="gs-guide">🏅GS Master🏅</option>
                    <option value="ls-guide">🏅LS Master🏅</option>
                    <option value="hammer-guide">🏅Hammer Master🏅</option>
                    <option value="hh-guide">🏅HH Master🏅</option>
                    <option value="lance-guide">🏅Lance Master🏅</option>
                    <option value="gl-guide">🏅GL Master🏅</option>
                    <option value="swaxe-guide">🏅Swaxe Master🏅</option>
                    <option value="tonfa-guide">🏅Tonfa Master🏅</option>
                    <option value="lbg-guide">🏅LBG Master🏅</option>
                    <option value="hbg-guide">🏅HBG Master🏅</option>
                    <option value="bow-guide">🏅Bow Master🏅</option>
                </select>
            </div>
            <div class="mb-3" id="descriptionField" style="display:none;">
                <label for="note" class="form-label">Description</label>
                <textarea class="form-control" id="note" rows="3"></textarea>
            </div>
            <div class="mb-3" id="imageUploadField" style="display:none;">
                <label for="imageUpload" class="form-label">Upload Image</label>
                <input class="form-control" type="file" id="imageUpload" name="imageUpload" accept="image/*" required>
            </div>
            <div class="mb-3" id="notesField" style="display:none;">
                <label for="notes" class="form-label">Notes on the Achievement Run</label>
                <textarea class="form-control" id="notes" rows="5"></textarea>
            </div>
            <button type="submit" class="btn btn-primary">Upload</button>
        </form>
    </div>

    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getStorage, ref, uploadBytesResumable, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-storage.js";
        import { getFirestore, collection, addDoc, serverTimestamp, doc, getDoc, updateDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyC-sUTBhiMtIfUm8JmA7Pv511d_lhijNYM",
            authDomain: "hunterachieves-github.firebaseapp.com",
            projectId: "hunterachieves-github",
            storageBucket: "hunterachieves-github.appspot.com",
            messagingSenderId: "996497090535",
            appId: "1:996497090535:web:7cf0aeb8948266d4857f42",
            measurementId: "G-7JJYYMJDNV"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const storage = getStorage(app);
        const db = getFirestore(app);

        // Check if user is logged in
        const username = localStorage.getItem('username');
        if (username) {
            document.getElementById('choiceForm').style.display = 'block';
            document.getElementById('uploadForm').style.display = 'block';
            document.getElementById('loginButton').style.display = 'none';
        }

        document.getElementById('choiceForm').addEventListener('change', function () {
            const choice = document.querySelector('input[name="contributionChoice"]:checked').value;
            const uploadForm = document.getElementById('uploadForm');
            const descriptionField = document.getElementById('descriptionField');
            const imageUploadField = document.getElementById('imageUploadField');
            const notesField = document.getElementById('notesField');

            uploadForm.style.display = 'block';

            if (choice === 'armorSet') {
                descriptionField.style.display = 'block';
                imageUploadField.style.display = 'block';
                imageUploadField.querySelector('input').required = true;
                notesField.style.display = 'none';
                notesField.querySelector('textarea').required = false;
            } else if (choice === 'achievementNotes') {
                descriptionField.style.display = 'none';
                imageUploadField.style.display = 'none';
                imageUploadField.querySelector('input').required = false;
                notesField.style.display = 'block';
                notesField.querySelector('textarea').required = true;
            }
        });

        document.getElementById('uploadForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const guide = document.getElementById('guideSelect').value;
            const username = localStorage.getItem('username');
            const choice = document.querySelector('input[name="contributionChoice"]:checked').value;

            const userDoc = await getDoc(doc(db, 'users', username));
            const profilePicture = userDoc.exists() ? userDoc.data().profilePicture : '';

            if (choice === 'armorSet') {
                const note = document.getElementById('note').value;
                const fileInput = document.getElementById('imageUpload');
                const file = fileInput.files[0];

                if (file) {
                    const storageRef = ref(storage, `images/${guide}/${file.name}`);
                    const uploadTask = uploadBytesResumable(storageRef, file);

                    uploadTask.on('state_changed',
                        (snapshot) => {
                            const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
                            console.log('Upload is ' + progress + '% done');
                        },
                        (error) => {
                            console.error('Upload failed:', error);
                        },
                        async () => {
                            const downloadURL = await getDownloadURL(uploadTask.snapshot.ref);
                            console.log('File available at', downloadURL);

                            await addDoc(collection(db, 'uploads'), {
                                guide,
                                username,
                                profilePicture,
                                note,
                                imageUrl: downloadURL,
                                timestamp: serverTimestamp()
                            });

                            alert('Upload successful!');
                            window.location.href = 'gallery.html';
                        }
                    );
                }
            } else if (choice === 'achievementNotes') {
                const notes = document.getElementById('notes').value;

                await addDoc(collection(db, 'notes'), {
                    guide,
                    username,
                    profilePicture,
                    notes,
                    timestamp: serverTimestamp()
                });

                alert('Upload successful!');
                window.location.href = 'communitynotes.html';
            }
        });
    </script>
        <div class="button-mode ">
            <input type="checkbox" class="checkbox" id="checkbox">
            <label for="checkbox" class="checkbox-label">
              <i class="fas fa-moon"></i>
              <i class="fas fa-sun"></i>
              <span class="ball"></span>
            </label>
          </div>
          
          
          
          <script>
           const checkbox = document.getElementById("checkbox");
          
          // Load the user's dark mode preference from localStorage
          document.addEventListener("DOMContentLoaded", () => {
              const isDarkMode = localStorage.getItem("darkMode") === "true";
              document.body.classList.toggle("dark", isDarkMode);
              checkbox.checked = isDarkMode;
          });
          
          checkbox.addEventListener("change", () => {
              const isDarkMode = checkbox.checked;
              document.body.classList.toggle("dark", isDarkMode);
              localStorage.setItem("darkMode", isDarkMode);
          });
          </script>
</body>
</html>
